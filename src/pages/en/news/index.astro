---
import { getCollection } from 'astro:content';
import NewsCarousel from '../../../components/NewsCarousel.astro';
import en from '../../../i18n/en.json';

const lang = 'en';
const t = en;
let all = await getCollection('news', ({ data }) => data.lang === lang && !data.draft);
if (all.length === 0) {
  all = await getCollection('news', ({ data }) => !data.draft);
}
const items = all.sort((a,b) => +new Date(b.data.date) - +new Date(a.data.date));
---
<html lang={lang}>
  <head>
    <title>Basola â€“ {t.news.title}</title>
    <meta name="description" content={t.news.tagline} />
    <link rel="icon" type="image/png" href="/assets/basola_favicon.png" />
  </head>
  <body class="bg-neutral-50">
    <section class="mx-auto max-w-6xl px-6 py-16">
      <header class="mb-8 flex items-end justify-between gap-4">
        <div>
          <h1 class="text-3xl md:text-4xl font-extrabold text-basola-brown">{t.news.title}</h1>
          <p class="mt-2 text-basola-brown/75">{t.news.tagline}</p>
        </div>
        <div class="flex gap-2">
          <a href="/news" class="rounded-full px-3 py-1 text-sm border border-basola-yellow/0 text-basola-brown/60 hover:border-basola-yellow/60 hover:bg-white">DE</a>
          <a href="/en/news" class="rounded-full px-3 py-1 text-sm border border-basola-yellow/60 text-basola-brown bg-white">EN</a>
          <a href="/es/news" class="rounded-full px-3 py-1 text-sm border border-basola-yellow/0 text-basola-brown/60 hover:border-basola-yellow/60 hover:bg-white">ES</a>
        </div>
      </header>
      <NewsCarousel
        items={items.map(({ slug, data }) => ({
          url: `/news/${slug}`,
          title: data.title,
          date: data.date,
          summary: data.summary,
          heroImage: data.heroImage
        }))}
        t={t.news}
        lang={lang}
      />
    </section>
  </body>
</html>
